---
# ============================================================
# VARIABLES PRINCIPALES - Projet VPN & Vault
# ============================================================
# Modifier ces valeurs AVANT le premier déploiement.
# Les secrets sont dans vault.yml (chiffré avec ansible-vault).

# --- Connexion SSH initiale ---
# IP ou FQDN du serveur cible
server_ip: "217.154.87.137"                    # Exemple: IP publique du serveur
# Port SSH (sera changé par le rôle security)
ssh_port: 22
# Utilisateur pour le déploiement initial (doit avoir un accès root ou sudo)
deploy_user: "root"
# Chemin vers la clé privée SSH locale
ssh_private_key_path: "~/.ssh/id_ed25519"

# --- Utilisateur système à créer ---
# Cet utilisateur remplacera root pour toute opération future
system_user: "mobuone"                      # Exemple: "jean", "admin-vpn"
# Clé publique SSH de l'utilisateur (contenu de ~/.ssh/id_ed25519.pub)
system_user_ssh_pubkey: "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHS9+WG0o2GiwHR4rhjgZ3AyE9Iy5nCzz/wUk9d3hQWJ erwin@ewutelo.cloud"

# --- Noms de domaine (obligatoires pour les certificats SSL) ---
# Chaque service a son propre sous-domaine
domain_headscale: "seko.ewutelo.cloud"           # Exemple: "hs.mondomaine.fr"
domain_headplane: "nga.ewutelo.cloud"          # Exemple: "nga.mondomaine.fr"
domain_vaultwarden: "fongola.ewutelo.cloud"      # Exemple: "vault.mondomaine.fr"
domain_portainer: "pao.ewutelo.cloud"    # Exemple: "portainer.mondomaine.fr"
domain_zerobyte: "buku.ewutelo.cloud"            # Exemple: "zb.mondomaine.fr"


# Email pour les certificats Let's Encrypt (via Caddy)
acme_email: "seko.mobutoo@gmail.com"

# --- Sécurité SSH ---
# Nouveau port SSH (changé après la première connexion)
ssh_custom_port: 804

# --- Docker ---
#docker_compose_version: "2.29.1"
# Compose est installé comme plugin CLI via docker-compose-plugin (apt).
# La version est gérée par le dépôt Docker, pas par une variable.
# Engine 29+ inclut Compose v5 automatiquement.

# --- Portainer ---
portainer_version: "lts"
# Port interne de Portainer (exposé uniquement via Caddy)
portainer_internal_port: 9443

# --- Headscale ---
headscale_version: "0.26.0"
# Préfixes IP pour le réseau VPN Headscale
headscale_ip_prefixes:
  - "100.64.0.0/10"
  - "fd7a:115c:a1e0::/48"
# Port gRPC pour headscale CLI (interne uniquement)
headscale_grpc_port: 50443
# Activer/désactiver les Magic DNS
headscale_magic_dns: true
headscale_base_domain: "nga.ewutelo.cloud"     # Domaine de base pour Magic DNS
# Configuration DERP personnalisée (pour se passer de Tailscale Inc)
# Mettre à true pour utiliser uniquement vos propres serveurs DERP
headscale_derp_auto_update: true
headscale_derp_update_frequency: "24h"

# --- Vaultwarden ---
vaultwarden_version: "1.35.1-alpine"
# Désactiver les inscriptions après la création du premier compte
vaultwarden_signups_allowed: true            # Passer à false après setup initial
# Nombre de workers Rocket
vaultwarden_rocket_workers: 4

# --- Réseau Docker ---
docker_network_name: "proxy-net"

# --- Firewall (UFW) ---
# Ports autorisés en entrée
ufw_allowed_ports:
  - { port: "22", proto: "tcp", comment: "SSH (sera remplacé par le port custom)" }
  - { port: "80", proto: "tcp", comment: "HTTP (redirect vers HTTPS)" }
  - { port: "443", proto: "tcp", comment: "HTTPS (Caddy)" }
  - { port: "3478", proto: "udp", comment: "STUN/DERP Headscale" }

# --- Fail2Ban ---
fail2ban_maxretry: 3
fail2ban_bantime: 3600
fail2ban_findtime: 600

# --- Chemins sur le serveur ---
base_deploy_path: "/opt/services"
headscale_data_path: "{{ base_deploy_path }}/headscale"
headplane_data_path: "{{ base_deploy_path }}/headplane"
vaultwarden_data_path: "{{ base_deploy_path }}/vaultwarden"
portainer_data_path: "{{ base_deploy_path }}/portainer"
caddy_data_path: "{{ base_deploy_path }}/caddy"
zerobyte_data_path: "{{ base_deploy_path }}/zerobyte"

# --- Headplane (Web UI Headscale) ---
headplane_version: "latest"

# --- Zerobyte (Gestion des sauvegardes) ---
zerobyte_version: "v0.25"

# --- Monit (Supervision) ---
domain_monit: "misu.ewutelo.cloud"            # Exemple: "monit.mondomaine.fr"
monit_check_interval: 30                     # Intervalle de vérification en secondes
monit_web_port: 2812                         # Port de l'interface web Monit (localhost only)
# Liste des conteneurs Docker à superviser
monit_containers:
  - headscale
  - headplane
  - vaultwarden
  - portainer
  - caddy
  - zerobyte
# Domaines à vérifier en HTTPS
monit_https_checks:
  - { name: "headscale", url: "{{ domain_headscale }}" }
  - { name: "headplane", url: "{{ domain_headplane }}" }
  - { name: "vaultwarden", url: "{{ domain_vaultwarden }}" }
  - { name: "portainer", url: "{{ domain_portainer }}" }
  - { name: "zerobyte", url: "{{ domain_zerobyte }}" }
# Seuils d'alerte système
monit_cpu_threshold: 90                      # % CPU
monit_mem_threshold: 85                      # % RAM
monit_disk_threshold: 85                     # % espace disque
monit_swap_threshold: 25                     # % swap
